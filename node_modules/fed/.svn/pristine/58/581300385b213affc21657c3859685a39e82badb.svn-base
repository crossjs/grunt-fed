var coffeeMiddleware, express, os, path;

coffeeMiddleware = require("coffee-middleware");

express = require("express");

os = require("os");

path = require("path");

exports.init = function(coffeeCfg) {
  return Hub.on("localServer.loadRoute.before", function(param) {
    var app;
    app = param.app;
    coffeeCfg.src = app.get("static resource");
    coffeeCfg.dest = !coffeeCfg.useTmpDir ? coffeeCfg.src : path.join(os.tmpDir(), "tmp_fed_coffee");
    app.use(coffeeMiddleware(coffeeCfg));
    if (coffeeCfg.useTmpDir) {
      return app.use(express["static"](coffeeCfg.dest));
    }
  });
};
